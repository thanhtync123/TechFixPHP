<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đặt Lịch - TECHFIX</title>
    <link href="/assets/css/book.css" rel="stylesheet" />

    <style>
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            color: #fff;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            opacity: 0;
            transition: opacity 0.4s;
            z-index: 9999;
        }
        .toast.show {
            opacity: 1;
        }
        .validation-message {
            color: #d9534f;
            font-size: 0.9rem;
            margin-top: 4px;
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="container flex justify-between items-center">
            <div class="flex items-center">
                <img src="/assets/image/hometech.jpg" alt="Logo"
                     style="width:40px; height:60px; object-fit:contain; margin-right:8px;" />
                <h1 class="logo" style="margin:8px; display:inline-block; line-height:60px;">
                    TECHFIX
                </h1>
            </div>
            <div class="nav-links flex items-center space-x-4">
                <a href="../index.html">Trang Chủ |</a>
                <a href="services.php">Dịch Vụ |</a> 
                <a href="about.html">Về Chúng Tôi |</a> 
                <a href="contact.html">Liên Hệ |</a> 
                <a href="admin_home.html">Trang Quản Trị</a> 
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="card">
            <div class="card-header">
                <h4>Đặt lịch dịch vụ</h4>
                <small>Trải nghiệm dịch vụ cao cấp ngay hôm nay</small>
            </div>
            <div class="card-body">
                <form id="bookingForm" method="POST">
                    
                    <div class="mb-2">
                        <label>Mã khách hàng</label>
                        <input type="number" id="idCustomer" name="IdCustomer" class="form-control" value="123" readonly />
                        <span class="validation-message" data-valmsg-for="IdCustomer"></span>
                    </div>
                    <div class="mb-2">
                        <label>Tên khách hàng</label>
                        <input type="text" id="customerName" name="CustomerName" class="form-control" value="Tên Khách Hàng Mẫu" readonly />
                        <span class="validation-message" data-valmsg-for="CustomerName"></span>
                    </div>
                    <div class="mb-2">
                        <label>Số điện thoại</label>
                        <input type="text" id="phone" name="Phone" class="form-control" value="0901234567" readonly />
                        <span class="validation-message" data-valmsg-for="Phone"></span>
                    </div>
                    <div class="mb-2">
                        <label>Địa chỉ</label>
                        <input type="text" id="address" name="Address" class="form-control" value="123 Đường ABC, Phường XYZ, Quận 1" readonly />
                        <span class="validation-message" data-valmsg-for="Address"></span>
                    </div>
                    <div class="mb-2">
                        <label>Tên dịch vụ</label>
                        <select id="serviceId" name="ServiceId" class="form-control">
                            <option value="0">-- Chọn dịch vụ --</option>
                            <option value="1">Sửa chữa & bảo trì hệ thống điện: 150,000</option>
                            <option value="2">Lắp đặt & bảo trì điều hòa: 300,000</option>
                            <option value="3">Sửa chữa tủ lạnh: 250,000</option>
                            <option value="4">Hỗ trợ kỹ thuật IT: 200,000</option>
                        </select>
                        <span class="validation-message" data-valmsg-for="ServiceId"></span>
                    </div>
                    <div class="mb-2">
                        <label>Thời gian hẹn</label>
                        <input type="date" id="appointmentTime" name="AppointmentTime" class="form-control" />
                        <span class="validation-message" data-valmsg-for="AppointmentTime"></span>
                    </div>
                    <button type="submit" class="btn btn-success">
                        Đặt lịch ngay
                    </button>
                </form>
            </div>
        </div>

        <div class="services-column">
            <section id="services" class="section">
                <h2 class="section-title">Các Dịch Vụ TECHFIX</h2>
                <div class="slider-container">
                    <div class="slider">
                        <div class="slide-track" id="slideTrack">
                            <div class="slide">
                                <img src="/assets/image/car.jpg" alt="car">
                                <h3>Sửa Chữa & Bảo Trì Xe</h3>
                                <p>
                                    Dịch vụ sửa chữa và bảo trì xe chuyên nghiệp, giúp phương tiện của bạn vận hành êm ái,
                                    an toàn và tiết kiệm chi phí. Chúng tôi cam kết mang đến trải nghiệm nhanh chóng và tin cậy.
                                </p>
                            </div>
                            <div class="slide">
                                <img src="/assets/image/pcc.jpg" alt="Sửa Chữa Máy Tính">
                                <h3>Sửa Chữa Máy Tính</h3>
                                <p>
                                    Sửa chữa máy tính từ phần cứng đến phần mềm, xử lý sự cố chậm, treo máy, hỏng hóc linh kiện.
                                    Đội ngũ kỹ thuật viên tận tâm sẽ khôi phục hiệu năng tối ưu cho thiết bị của bạn.
                                </p>
                            </div>
                            <div class="slide">
                                <img src="/assets/image/elec.jpg" alt="Electrical">
                                <h3>Sửa chữa & bảo trì hệ thống điện</h3>
                                <p>
                                    Dịch vụ điện dân dụng và công nghiệp toàn diện: sửa chữa, lắp đặt, bảo trì hệ thống điện.
                                    Đảm bảo an toàn, ổn định và tiết kiệm điện năng cho gia đình cũng như doanh nghiệp.
                                </p>
                            </div>
                            <div class="slide">
                                <img src="/assets/image/air.jpg" alt="air-conditioned">
                                <h3>Sửa Chữa & Vệ Sinh Điện Lạnh</h3>
                                <p>
                                    Vệ sinh, sửa chữa và bảo trì hệ thống điện lạnh định kỳ. Giúp máy lạnh, tủ lạnh hoạt động hiệu quả,
                                    mang lại không gian trong lành, thoáng mát và nâng cao tuổi thọ thiết bị.
                                </p>
                            </div>
                        </div>
                    </div>
                    <button class="control-btn" id="prevBtn">❮</button>
                    <button class="control-btn" id="nextBtn">❯</button>
                    <div class="pagination" id="pagination"></div>
                </div>

                <div class="more-btn-container" style="text-align: center; margin-top: 20px;">
                    <a href="services.php" class="more-btn">Tìm Hiểu Thêm</a> 
                </div>

                <div class="company-info">
                    <img src="/assets/image/hometech.jpg" alt="Techfix Logo" class="company-logo" />
                    <div class="company-description">
                        <h3>Về TECHFIX</h3>
                        <p>
                            TECHFIX là web trong lĩnh vực kỹ thuật & công nghệ, cung cấp các giải pháp sáng tạo và dịch vụ sửa chữa chất lượng cao. Chúng tôi cam kết mang đến trải nghiệm tốt nhất cho khách hàng.
                        </p>
                    </div>
                    <div class="map-container">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d15705.130930698686!2d105.98417167672112!3d10.238765824299422!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2s!4v1759656345208!5m2!1sen!2s" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div class="footer">
        <div>
            <h3>TECHFIX</h3>
            <p>ĐẶT NIỀM TIN - TRAO CHỮ TÍN</p>
        </div>
        <div>
            <h3>Liên Kết Nhanh</h3>
            <a href="#services">Dịch Vụ</a> |
            <a href="#about">Về Chúng Tôi</a> |
            <a href="#contact">Liên Hệ</a>
        </div>
        <div>
            <h3>Thông Tin Liên Hệ</h3>
            <p>Email: support@techfix.com</p>
            <p>Điện thoại: +84 123 456 789</p>
            <p>Địa chỉ: P4 Phạm Thái Bường</p>
        </div>
        <p class="copy">© 2025 TECHFIX. All rights reserved.</p>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        // Script cho Slider
        document.addEventListener("DOMContentLoaded", function () {
            const track = document.getElementById("slideTrack");
            const slides = track ? track.children : [];
            const prevBtn = document.getElementById("prevBtn");
            const nextBtn = document.getElementById("nextBtn");
            const pagination = document.getElementById("pagination");
            let index = 0;

            if (pagination && slides.length > 0) {
                pagination.innerHTML = "";
                for (let i = 0; i < slides.length; i++) {
                    const dot = document.createElement("span");
                    dot.addEventListener("click", () => showSlide(i));
                    pagination.appendChild(dot);
                }
            }

            function updatePagination() {
                if (!pagination) return;
                [...pagination.children].forEach((dot, i) => {
                    dot.classList.toggle("active", i === index);
                });
            }

            function showSlide(i) {
                if (!track || slides.length === 0) return;
                if (i < 0) index = slides.length - 1;
                else if (i >= slides.length) index = 0;
                else index = i;
                track.style.transform = `translateX(-${index * 100}%)`;
                updatePagination();
            }

            if (prevBtn && nextBtn) {
                prevBtn.addEventListener("click", () => showSlide(index - 1));
                nextBtn.addEventListener("click", () => showSlide(index + 1));
            }

            if (slides.length > 0) {
                setInterval(() => {
                    showSlide(index + 1);
                }, 5000); // Tự động chuyển slide sau 5 giây
            }
            showSlide(0); // Hiển thị slide đầu tiên
        });
    </script>
    
    <script>
        // Script cho Form và Toast
        const bookingForm = document.getElementById("bookingForm");
        const toast = document.getElementById("toast");

        // Hàm hiển thị Toast
        function showToast(message, type = "info") {
            toast.textContent = message;
            toast.style.background = type === "error" ? "#d9534f" :
                                     type === "success" ? "#28a745" :
                                     type === "warning" ? "#f0ad4e" : "#333";
            toast.classList.add("show");
            setTimeout(() => toast.classList.remove("show"), 3000);
        }
        
        // Đặt giá trị ngày mặc định cho ô input date
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0'); // Tháng 0-11
        const dd = String(today.getDate()).padStart(2, '0');
        document.getElementById('appointmentTime').value = `${yyyy}-${mm}-${dd}`;

        // Xử lý logic khi submit form
        bookingForm.addEventListener("submit", async (e) => {
            e.preventDefault(); // Ngăn form gửi đi

            const formData = new FormData(bookingForm);
            const orderData = Object.fromEntries(formData.entries());
            orderData.Status = "pending";
            
            console.log("Dữ liệu đơn hàng gửi đi:", orderData);
            
            // === VIẾT LOGIC JAVASCRIPT CỦA BẠN TẠI ĐÂY ===
            try {
                // 1. Giả lập gọi API
                // const res = await fetch("/api/create-booking", { ... });
                // if (!res.ok) throw new Error("Tạo đơn hàng thất bại!");

                // 2. Hiển thị thành công (Giả lập)
                showToast("Đã gửi yêu cầu, Kỹ thuật viên sẽ sớm liên hệ với bạn", "success");

                // 3. Chờ 2 giây rồi chuyển hướng
                setTimeout(() => {
                    window.location.href = "index.html"; // Chuyển về trang chủ
                }, 2000);

            } catch (err) {
                // 4. Hiển thị thất bại
                console.error("Lỗi đặt lịch:", err.message);
                showToast(err.message, "error");
            }
        });
    </script>

</body>
</html>